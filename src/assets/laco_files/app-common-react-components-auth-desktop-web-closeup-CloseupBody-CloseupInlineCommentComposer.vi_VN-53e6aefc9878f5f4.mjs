(self.modernJsonp=self.modernJsonp||[]).push([["98899"],{497221(e,t,n){n.r(t),n.d(t,{default:()=>j});var i=n(97407),o=n(296540),a=n(328138),r=n(381681),s=n(100559),m=n(671468),d=n(133965),l=n(632321),c=n(427575),p=n(55268),u=n(449798),g=n(643357),_=n(718244),f=n(211974),C=n(398304),A=n(755701),y=n(741345),h=n(922149),w=n(808993),I=n(474848),x=n(486334),S=n(243042);let P=(0,o.memo)(function({aggregatedPinDataId:e,closeupAttributionId:t,commentCount:n,disablePhotoCommentSelection:i,isEligibleForPinReactions:P,isPDP:j,pinId:v,privatePin:M,reactionByMe:T,reactionCounts:b,setIsLoadingNewlyCreatedComment:N,showCommentComposer:E,showReactBackground:O,storyPinDataId:U,viewParameter:z}){let{clientTrackingParams:B}=(0,S._G)(),Y=(0,r.A)({showProductDetailPage:!!j}),{handleAddComment:$}=function(){let e=(0,m.wA)(),t=(0,d.A)(),{updateAggregatedComment:n}=(0,y.Vc)(),{logContextEvent:i}=(0,l.o)(),{showOneToast:o}=(0,f.CG)(),a=(0,u.A)(),r=(0,C.A)(),x=(0,A.H7)(a,r),S=(0,g.A)();return{handleAddComment:async function(r,m,d,l,u,g,f,C,A,y){let{commentMedia:P,contentMarkdown:j,force:v,imageSignatures:M,tags:T}=r,b=!!y,N=!!A;if(!m)return!1;try{if(m){if(N)A.type===h.$.didIt?await e((0,w.pU)({id:A.id,details:j,pinId:d??"",image_signatures:"image_signatures"in A&&A.image_signatures?A.image_signatures:[]})):await n({commentId:A.id,force:v,orbacSubjectId:x,tags:T,text:j});else if(M.length){let t={aggregatedPinDataId:m,details:j,image_signatures:M,pin_id:d??"",username:a.isAuth&&a.username||"",fromUnifiedComment:!0};await e((0,w.OP)(t))}else if(b){let e=y?.parentType!==h.$.pin,n=e?y?.parentType===h.$.didIt:y?.type===h.$.didIt,i=e?y?.parentId||"":y?.id,o=n?h.S.didIt:h.S.aggregatedComment,a=e?y?.id:void 0;await t({force:v,fromUnifiedComment:!0,objectType:o,objectId:i,pinId:d,orbacSubjectId:x,replyToCommentId:a,tags:T,text:j})}else await t({commentMedia:P,force:v,fromUnifiedComment:!0,objectType:h.S.pin,objectId:m,pinId:d,tags:T,text:j,orbacSubjectId:x});i({event_type:7,clientTrackingParams:g,object_id_str:d,aux_data:{num_user_mention_tags:(T?JSON.parse(T):[]).length,...l?{creator_id:u,story_pin_data_id:l}:{}}})}}catch(e){return[_.wg,_.HU].includes((0,c.A)(e,"api_error_code")??0)?f((0,c.A)(e,"api_error_code")===_.wg?s.YM.WARNING:s.YM.BLOCK):o(({hideToast:t})=>(0,I.jsx)(p.A,{onHide:t,text:(0,c.A)(e,"message_detail")||(0,c.A)(e,"message")||S.bt("Đã xảy ra sự cố khi đăng nhận xét của bạn.", "There was an issue posting your comment.", "comment.post.errorMessage", undefined, true),type:"error"})),!1}return C(!1),!0}}}(),[k,G]=(0,o.useState)(!1),[H,J]=(0,o.useState)(s.YM.NONE);async function R(n){if(null===e)return!1;N(!0);try{return await $(n,e,v,U??void 0,t??void 0,B,J,G)}finally{N(!1)}}return(0,I.jsx)(a.az,{marginTop:4*!!Y,children:(0,I.jsx)(x.A,{clientTrackingParams:B,commentCount:n,commentWarningModalState:H,disablePhotoCommentSelection:i,dismissCommentWarningModal:()=>J(s.YM.NONE),iconSize:j?20:void 0,isEligibleForPinReactions:P,isLeftAligned:j,objectType:h.S.pin,onAddItem:R,onCancelItem:()=>G(!1),onEnter:()=>G(!0),pinId:v,privatePin:M,reactionByMe:T,reactionCounts:b,showCommentComposer:E,showReactBackground:!j&&O,statusType:k?"textInflightCreation":"textStaticDisplay",viewParameter:z})})});function j(e){return(0,o.useEffect)(()=>{(0,i.A)("CloseupInlineCommentComposer","/app/common/react/components/auth-desktop-web-closeup/CloseupBody/CloseupInlineCommentComposer.tsx")},[]),(0,I.jsx)(P,{...e})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/app-common-react-components-auth-desktop-web-closeup-CloseupBody-CloseupInlineCommentComposer.vi_VN-53e6aefc9878f5f4.mjs.map